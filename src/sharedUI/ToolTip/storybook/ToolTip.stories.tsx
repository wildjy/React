import type { Meta, StoryFn } from '@storybook/react';
import { useEffect, useState } from 'react';
import { Button } from '../../Button/Button'; // ë²„íŠ¼ ê²½ë¡œì— ë§ê²Œ ì¡°ì •
import { ToolTip } from '../ToolTip';
import { ToolTipTexts } from '../ToolTipTexts';

const meta: Meta<typeof ToolTip> = {
  title: 'UI/ToolTip/ToolTip',
  component: ToolTip,
  tags: ['autodocs'],
  parameters: {
    docs: {
      description: {
        component:
          'ğŸ§­ `ToolTip`ì€ ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ ì—´ë¦¬ê³  ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«íˆëŠ” íˆ´íŒ íŒì—… ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. `type`, `align`, `outClose` ì˜µì…˜ì„ í†µí•´ ë‹¤ì–‘í•œ ìœ„ì¹˜ ë° ë™ì‘ ì œì–´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
      },
    },
  },
  argTypes: {
    iconUrl: {
      control: 'text',
      description: 'íˆ´íŒì„ ì—¬ëŠ” ì•„ì´ì½˜ URL (ë°°ê²½ ì´ë¯¸ì§€)',
    },
    type: {
      control: 'radio',
      options: ['base', 'layer'],
      description: 'íˆ´íŒ ìœ„ì¹˜ íƒ€ì…(layerì¼ë• align ì ìš©ë¶ˆê°€)',
    },
    align: {
      control: 'radio',
      options: ['left', 'center', 'right'],
      description: '`type="base"`ì¼ ê²½ìš° ì •ë ¬ ìœ„ì¹˜',
    },
    justify: {
      control: 'radio',
      options: ['start', 'center', 'end'],
      description: 'íˆ´íŒ wrapperì˜ justify ì„¤ì •',
    },
    close: {
      control: 'boolean',
      description: 'ë‹«ê¸° ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€',
    },
    outClose: {
      control: 'boolean',
      description: 'íˆ´íŒ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«íˆëŠ” ì—¬ë¶€',
    },
    isOpen: {
      control: 'boolean',
      description: 'íˆ´íŒ ì—´ë¦¼ ì—¬ë¶€ (ì œì–´í˜•)',
    },
    addClass: {
      control: 'text',
      description: 'íˆ´íŒì— ì¶”ê°€í•  í´ë˜ìŠ¤',
    },
    onClick: {
      action: 'clicked',
      description: 'ì•„ì´ì½˜ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸',
    },
  },
};

export default meta;

const dummyDatas = [
  {
    title: 'íˆ´íŒ title 1',
    text: 'íˆ´íŒ ë‚´ìš© 1ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤.',
  },
  {
    title: 'íˆ´íŒ title 2',
    text: (
      <>
        íˆ´íŒ ë‚´ìš© 2ê°€ ë“¤ì–´ê°‘ë‹ˆë‹¤. <br />
        ì—¬ëŸ¬ ì¤„ì˜ í…ìŠ¤íŠ¸ë„ ë¬¸ì œì—†ìŠµë‹ˆë‹¤.
      </>
    ),
  },
  {
    text: (
      <>
        ì œëª© ì—†ì´ë„ ë³¸ë¬¸ í…ìŠ¤íŠ¸ë§Œ ë…¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br />
        ì—¬ëŸ¬ ì¤„ì˜ í…ìŠ¤íŠ¸ë„ ë¬¸ì œì—†ìŠµë‹ˆë‹¤.
      </>
    ),
  },
  {
    title: 'íˆ´íŒ title 3',
    text: 'íˆ´íŒ ë‚´ìš© 3ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤.',
  },
];

const Template: StoryFn<typeof ToolTip> = (args) => {
  const [open, setOpen] = useState<boolean>(args.isOpen ?? false);

  useEffect(() => {
    setOpen(args.isOpen ?? false);
  }, [args.isOpen]);

  const justifyClass = {
    start: 'justify-start',
    center: 'justify-center',
    end: 'justify-end',
  }[args.justify || 'start'];

  return (
    <div className={`flex flex-wrap ${justifyClass} gap-3 h-[250px]`}>
      <span>íˆ´íŒ (ToolTip)</span>
      <ToolTip
        {...args}
        isOpen={open}
        onClick={() => {
          setOpen((prev) => !prev);
          args.onClick?.();
        }}
      >
        {dummyDatas.map((data, index) => (
          <div key={index} className="mt-3 first:mt-0">
            <ToolTipTexts title={data.title} text={data.text} />
          </div>
        ))}
        {!args.close && (
          <div className="md:mt-2">
            <Button size="sm" onClick={() => setOpen(false)}>
              ë‹«ê¸°
            </Button>
          </div>
        )}
      </ToolTip>
    </div>
  );
};

export const Default = Template.bind({});
Default.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_tooltip.svg',
  type: 'base',
  align: 'left',
  close: true,
  outClose: false,
  isOpen: false,
  addClass: '',
};

export const Layer = Template.bind({});
Layer.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_tooltip.svg',
  type: 'layer',
  align: 'left',
  close: true,
  isOpen: false,
  addClass: '',
};

export const Align = Template.bind({});
Align.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_tooltip.svg',
  type: 'base',
  align: 'right',
  close: true,
  isOpen: false,
  addClass: '',
  justify: 'end',
};

export const NoClose = Template.bind({});
NoClose.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_tooltip.svg',
  type: 'base',
  align: 'left',
  close: false,
  outClose: true,
  isOpen: false,
  addClass: '',
};

export const NoOutClose = Template.bind({});
NoOutClose.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_tooltip.svg',
  type: 'base',
  align: 'left',
  close: true,
  outClose: false,
  isOpen: false,
  addClass: '',
};

export const CustomIcon = Template.bind({});
CustomIcon.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_plus.svg',
  type: 'layer',
  align: 'left',
  close: true,
  isOpen: false,
  addClass: '',
};

export const CustomLayerClass = Template.bind({});
CustomLayerClass.args = {
  iconUrl: 'https://image.jinhak.com/jinhakImages/react/icon/icon_tooltip.svg',
  type: 'base',
  align: 'left',
  close: true,
  isOpen: false,
  addClass: 'min-w-[300px] bg-gray-50',
};
